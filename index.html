<html>
<head>
  <title></title>
  <meta http-equiv="X-UA-Compatible" content="IE=8" />
  <script type="text/javascript" src="vendor/underscore.js"></script>
  <script type="text/javascript" src="vendor/jquery-1.9.1.min.js"></script>
  <script type="text/javascript" src="dist/nox.js"></script>
  <style type="text/css">
    .highlight-true {
      background: green;
    }
    .error-true {
      color: red;
    }
  </style>
  <script type="text/javascript">

    var PRIOS = [
      "low",
      "normal",
      "high"
    ];

    var LoginForm = function(){
      this.email = "";
      this.password = "";

      this.validator = new Nox.Validator();
      this.validator.field("email", true).length({min: 3, max: 10});
    };

    LoginForm.prototype.submit = function(){
      if(this.validator.validate(this)){
        console.info("validate true");
      }else{
        console.info("validate false");
      }
    };

    var app = {
          name: "joe",
          emptyName: "",
          entries: [],
          loginForm: new LoginForm()
        },
        vars = {};

    app.numDone = function(){
      return _.where(this.entries, {done: true}).length;
    };

    app.removePerson = function(person){
      this.entries = _.without(this.entries, person);
    };

    for(var i=0; i < 3; i++){
      app.entries.push({id: _.uniqueId(), name: "xxx", done: false});
    }

    app.createData = function(){
      for(var i=0; i < 100; i++){
        this.entries.push({id: _.uniqueId(), name: "xxx"+i, done: false});
      }
    };

    app.freeData = function(){
      this.entries = [];
    };

    $(function(){
      Nox.initAndUpdateBindings(app);
    });
  </script>
</head>
<body>

  <p>we have {{this.entries.length}} entries ({{this.numDone()}} done)</p>

  <div>
    <a href="#" data-click="this.createData()">create</a>
    <a href="#" data-click="this.freeData()">free</a>
  </div>

  <hr/>

  <form>
    <!--label class="error-{{this.loginForm.validator.isInvalid('email')}}">Email</label-->
    <label data-error-email="this.loginForm.validator">Email</label>
    <input type="text" data-value="this.loginForm.email"/>
    <button data-click="this.loginForm.submit()">submit</button>
  </form>

  <hr/>

  <ul data-loop="PRIOS">
    <li>{{entry}}</li>
  </ul>

  <hr/>

  
<!--  data-show="this.name.length > 10" -->
  <ul data-loop-person="this.entries">
    <li>
      <input type="checkbox" data-check="person.done"/>
      <span data-text="this.name"></span>
      <span data-text="person.name"></span>
      <input data-value="this.name" class="color-{{this.name.length > 5 ? 'red' : 'none'}}"/>
      <input data-value="this.name"/>
      <input data-value="this.name"/>
      <input data-value="this.name"/>
      <input data-value="person.name"/>
      <a href="#" data-click="alert(person.name + ', ' + person.id)">action</a>
      <a href="#" data-click="this.removePerson(person)">remove</a>
    </li>
  </ul>

  <span data-text="this.name"></span>

  <input data-value="this.name"/>
  <input placeholder="xx" data-valuePlaceholder="this.emptyName"/>

</body>
</html>